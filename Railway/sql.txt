"SELECT 
	TT1.TRAIN_ID,
	(SELECT NAME FROM TRAIN T1 WHERE T1.TRAIN_ID=TT1.TRAIN_ID) NAME1,
	TT1.DEPARTURE_TIME,
	TT2.DEPARTURE_TIME,
	ROW_NUMBER() Over (ORDER BY TO_TIMESTAMP(LPAD(TT1.DEPARTURE_TIME,4,'0'), 'HH24:MI')) As SN " \
"FROM 
	TRAIN_TIMETABLE TT1,TRAIN_TIMETABLE TT2 " \
"WHERE 
	(TT1.DIRECTION='FROM' AND TT1.STATION_ID=(SELECT STATION_ID FROM STATION WHERE NAME=%s)) 
	AND (TT2.DIRECTION='TO' AND TT2.STATION_ID=(SELECT STATION_ID FROM STATION WHERE NAME=%s)) 
	AND (TT1.TRAIN_ID=TT2.TRAIN_ID) 
	AND TO_DATE(CONCAT(CONCAT(CONCAT(TO_CHAR(SYSDATE, 'YYYY-MM-DD'),' '),TT1.DEPARTURE_TIME),':00'),'YYYY-MM-DD HH24:MI:SS')>SYSDATE " \
"ORDER BY 
	TO_TIMESTAMP(LPAD(TT1.DEPARTURE_TIME,4,'0'), 'HH24:MI');"







SELECT 
	TT1.TRAIN_ID,
	(SELECT TRAIN_NAME FROM TRAIN T1 WHERE T1.TRAIN_ID=TT1.TRAIN_ID) NAME1,
	TT1.DEPARTURE_TIME,
	TT2.DEPARTURE_TIME,
	ROW_NUMBER() Over (ORDER BY TO_TIMESTAMP(LPAD(TT1.DEPARTURE_TIME,4,'0'), 'HH24:MI')) As SN 
FROM 
	TRAIN_TIMETABLE TT1,TRAIN_TIMETABLE TT2 
WHERE 
	(TT1.DIRECTION='FROM' AND TT1.STATION_ID=(SELECT STATION_ID FROM STATION WHERE NAME=%s)) 
	AND (TT2.DIRECTION='TO' AND TT2.STATION_ID=(SELECT STATION_ID FROM STATION WHERE NAME=%s)) 
	AND (TT1.TRAIN_ID=TT2.TRAIN_ID)
ORDER BY 
	TO_TIMESTAMP(LPAD(TT1.DEPARTURE_TIME,4,'0'), 'HH24:MI');"









select 
	NVL((TRUNC(COST*%s)+TRUNC(COST*%s*0.5)),0)
FROM 
	COST
WHERE 
	STATION_ID=(SELECT STATION_ID from STATION where NAME=%s) 
	AND TO_STATION_ID=(SELECT STATION_ID from STATION where NAME=%s)"






SELECT 
	78-COUNT(*) 
FROM 
	BOOKED_SEAT 
WHERE 
	TRAIN_ID=%s 
	AND CLASS='SNIGDHA' 
	AND TRUNC(DATE_OF_JOURNEY)= TO_DATE(%s,'YYYY-MM-DD');"








SELECT 
	TT1.TRAIN_ID,
	(SELECT TRAIN_NAME FROM TRAIN T1 WHERE T1.TRAIN_ID=TT1.TRAIN_ID) NAME1,
	TT1.DEPARTURE_TIME,
	TT2.DEPARTURE_TIME,
	ROW_NUMBER() Over (ORDER BY TO_TIMESTAMP(TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS'),'HH24:MI:SS')) As SN
FROM 
	TRAIN_TIMETABLE TT1,TRAIN_TIMETABLE TT2
WHERE 
	(TT1.DIRECTION='KAMALAPUR' AND TT1.STATION_ID=(SELECT STATION_ID FROM STATION WHERE STATION_NAME='KAMALAPUR')) 
	AND (TT2.DIRECTION='CHITTAGONG' AND TT2.STATION_ID=(SELECT STATION_ID FROM STATION WHERE STATION_NAME='CHITTAGONG')) 
	AND (TT1.TRAIN_ID=TT2.TRAIN_ID) 
	AND TO_DATE(CONCAT(CONCAT(TO_CHAR(SYSDATE, 'YYYY-MM-DD'),' '),TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS')),'YYYY-MM-DD HH24:MI:SS')>SYSDATE
ORDER BY 
	TO_TIMESTAMP(TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS'),'HH24:MI:SS')
	;




drop trigger deletereserve
    after insert
    on RESERVED_SEAT
    for each row
BEGIN
 DELETE from RESERVATION r 
 WHERE r.RESERVATION_ID IN 
 (SELECT RESERVATION_ID FROM RESERVATION WHERE EXTRACT(MINUTE FROM(sysdate-DATE_OF_RESERVATION)) > 10 AND PAYMENT_STATUS='pending');
END;
/







TO_TIMESTAMP( concat(concat(TO_CHAR((SELECT SYSDATE FROM DUAL),'YYYY-MM-DD'),' '),TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS')),'YYYY-MM-DD HH24:MI:SS') 




CREATE OR REPLACE FUNCTION CHECKMAIL(MAIL IN VARCHAR2) RETURN VARCHAR2 IS
TEMP NUMBER;
MESG VARCHAR2(1000);
BEGIN
SELECT COUNT(*) INTO TEMP FROM ACCOUNTS WHERE EMAIL=MAIL;
IF TEMP=0 THEN
MESG:='NOTEXIST';
ELSE
MESG:='EXIST';
END IF;
RETURN MESG;
END;
/
