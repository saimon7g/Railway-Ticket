SELECT 
	TT1.TRAIN_ID,
	(SELECT TRAIN_NAME FROM TRAIN T1 WHERE T1.TRAIN_ID=TT1.TRAIN_ID) NAME1,
	TT1.DEPARTURE_TIME,
	TT2.DEPARTURE_TIME,
	ROW_NUMBER() Over (ORDER BY TO_TIMESTAMP(TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS'),'HH24:MI:SS')) As SN 
FROM 
	TRAIN_TIMETABLE TT1,TRAIN_TIMETABLE TT2 
WHERE 
	(TT1.DIRECTION='KAMALAPUR' AND TT1.STATION_ID=(SELECT STATION_ID FROM STATION WHERE STATION_NAME='KAMALAPUR')) 
	AND (TT2.DIRECTION='CHITTAGONG' AND TT2.STATION_ID=(SELECT STATION_ID FROM STATION WHERE STATION_NAME='CHITTAGONG')) 
	AND (TT1.TRAIN_ID=TT2.TRAIN_ID) 
	AND TO_DATE(CONCAT(CONCAT(TO_CHAR(SYSDATE, 'YYYY-MM-DD'),' '),TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS')),'YYYY-MM-DD HH24:MI:SS')>SYSDATE 
ORDER BY 
	TO_TIMESTAMP(TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS'),'HH24:MI:SS');






SELECT 
	TT1.TRAIN_ID,
	(SELECT TRAIN_NAME FROM TRAIN T1 WHERE T1.TRAIN_ID=TT1.TRAIN_ID) NAME1,
	TT1.DEPARTURE_TIME,
	TT2.DEPARTURE_TIME,
	ROW_NUMBER() Over (ORDER BY TO_TIMESTAMP(TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS'),'HH24:MI:SS')) As SN 
FROM 
	TRAIN_TIMETABLE TT1,TRAIN_TIMETABLE TT2 
WHERE 
	TT1.DIRECTION=TT2.DIRECTION
	AND TT1.STATION_ID=(SELECT STATION_ID FROM STATION WHERE STATION_NAME='KAMALAPUR') 
	AND TT2.STATION_ID=(SELECT STATION_ID FROM STATION WHERE STATION_NAME='CHITTAGONG') 
	AND (TT1.TRAIN_ID=TT2.TRAIN_ID) 
	AND TT1.DEPARTURE_TIME>TT2.DEPARTURE_TIME 
ORDER BY 
	TO_TIMESTAMP(TO_CHAR(TT1.DEPARTURE_TIME,'HH24:MI:SS'),'HH24:MI:SS');